<html><head><title>Mandatory uvm_object Constructors</title><link rel="stylesheet" type="text/css" href="../../styles/main.css"><script language=JavaScript src="../../javascript/main.js"></script></head><body class="FramedContentPage" onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version Development Release 01-12-2008 (1.35 base) -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org --> 








 <!--TOP - START OF CONTENT-->
<div id=Content>


 <!--CONTENT index=0 -->
<div class="CSection"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="Mandatory_uvm_object_Constructors" href="../../../../../uvm_ref/relnotes/Mantis_3770.txt">Mandatory uvm_object Constructors</a></h1><div class=CBody><p>This page describes important actions users need to take before the next UVM release.</p><p>The factory is being updated so that it passes the instance name into the object&rsquo;s constructor.&nbsp; This update allows the instance name specified by the user to the factory to be used in the constructor as in the examples shown below.&nbsp; However, if an object has no constructor defined, it will use a default constructor with no argument, resulting in a compile-time error for mismatching arguments.</p>

<!--START_ND_SUMMARY index=0-->
<div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable>
  <!-- index=0 -->

<tr class="SMain"><td colspan=2 class=SEntry><a href="#Mandatory_uvm_object_Constructors" >Mandatory uvm_object Constructors</a></td></tr>
<tr class=SMain><td colspan=2 class=SWideDescription>This page describes important actions users need to take before the next UVM release.</td></tr>
  <!-- index=1 -->

<tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Why_uvm_object_constructors_are_now_mandatory" >Why uvm_object constructors are now mandatory</a></td><td class=SDescription>The UVM recommends that the following constructor be specified for any class extended from <a href="../../files/base/uvm_object-svh.html#uvm_object" class=LClass id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">uvm_object</a>:</td></tr>
  <!-- index=2 -->

<tr class="SGeneric SIndent1"><td class=SEntry><a href="#What_users_should_do_as_soon_as_possible" >What users should do as soon as possible</a></td><td class=SDescription>In UVM 1.1a, the behavior of the UVM object factory retains its previous (if incorrect) behavior by default. </td></tr>
  <!-- index=3 -->

<tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#What_will_happen_in_UVM_1.2" >What will happen in UVM 1.2?</a></td><td class=SDescription>In UVM 1.2, the UVM object factory will have the corrected behavior enabled by default. </td></tr>
  <!-- index=4 -->

<tr class="SGeneric SIndent1"><td class=SEntry><a href="#What_will_happen_in_UVM_1.3" >What will happen in UVM 1.3?</a></td><td class=SDescription>In UVM 1.3, the UVM object factory will have the corrected behavior <b>ONLY</b>. </td></tr></table></div></div><!--END_ND_SUMMARY-->
</div></div></div>




 <!--CONTENT index=1 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Why_uvm_object_constructors_are_now_mandatory" href="../../../../../uvm_ref/relnotes/Mantis_3770.txt">Why uvm_object constructors are now mandatory</a></h3><div class=CBody><p>The UVM recommends that the following constructor be specified for any class extended from <a href="../../files/base/uvm_object-svh.html#uvm_object" class=LClass id=link2 onMouseOver="ShowTip(event, 'tt1', 'link2')" onMouseOut="HideTip('tt1')">uvm_object</a>:</p><blockquote><pre>class my_obj extends uvm_object;
    ...
    `uvm_object_utils(my_obj)

    function new(string name = &quot;my_obj&quot;)
      super.new(name);
      ...
    endfunction
    ...
endclass</pre></blockquote><p>However, in UVM 1.0 and UVM 1.1, the presence of such a constructor is not enforced by the library and they are technically optional.&nbsp; If no constructor is specified, a default constructor is provided by SystemVerilog:</p><blockquote><pre>class my_obj extends uvm_object;
    ...
    `uvm_object_utils(my_obj)

    function new();
    endfunction
    ...
endclass</pre></blockquote><p>Note the important difference: in the default constructor, there is no <i>name</i> argument.&nbsp; Because the factory could not rely on the presence of that argument, <a href="../../files/base/uvm_object-svh.html#uvm_object" class=LClass id=link3 onMouseOver="ShowTip(event, 'tt1', 'link3')" onMouseOut="HideTip('tt1')">uvm_object</a> instances were created by calling <i>new()</i> without any arguments and subsequently setting the object instance name using <a href="../../files/base/uvm_object-svh.html#uvm_object.set_name" class=LMethod id=link4 onMouseOver="ShowTip(event, 'tt2', 'link4')" onMouseOut="HideTip('tt2')">uvm_object::set_name</a>.</p><blockquote><pre>obj = new();
if (name != &quot;&quot;) obj.set_name(name);</pre></blockquote><p>In most cases, this difference is not significant.&nbsp; However, for any class that makes use of the value of the <i>name</i> argument in the constructor,</p><blockquote><pre>class my_obj extends uvm_object;
    your_obj sub;

    `uvm_object_utils(my_obj)

    function new(string name = &quot;my_obj&quot;)
      super.new(name);
      sub = your_obj::type_id::create({name,&quot;.sub&quot;});
    endfunction
    ...
endclass</pre></blockquote><p>a difference in behavior will be observed between instantiating an object directly:</p><blockquote><pre>my_obj o = new(&quot;o&quot;);</pre></blockquote><p>and instantiating an object via the factory:</p><blockquote><pre>my_obj o = my_obj::type_id::create(&quot;o&quot;);</pre></blockquote><p>The difference may often be worked around by overriding the <a href="../../files/base/uvm_object-svh.html#uvm_object.set_name" class=LMethod id=link5 onMouseOver="ShowTip(event, 'tt2', 'link5')" onMouseOut="HideTip('tt2')">uvm_object::set_name()</a> method to percolate the effect of the name change.&nbsp; However, that work-around may often be impossible or too late.&nbsp; In the examples above, the former will create an instance of <i>your_obj</i> named &ldquo;o.sub&rdquo; whereas the latter will create an instance named &ldquo;my_obj.sub&rdquo;.&nbsp; This will make it impossible to control the sub-object factory based on the parent object name.</p><p>Instantiating coverage group is another example where the work-around would not work.&nbsp; Coverage groups cannot be renamed and must be instantiated in the encapsulating object&rsquo;s constructor.&nbsp; The following example would create coverage groups that are always named &ldquo;my_obj&rdquo; when using the object factory.</p><blockquote><pre>class my_obj extends uvm_object;
    covergroup my_cg(string name);
       option.name = name;
       ...
    endgroup

    `uvm_object_utils(my_obj)

    function new(string name = &quot;my_obj&quot;)
      super.new(name);
      my_cg = new(name);
    endfunction
    ...
endclass</pre></blockquote><p>Because the object factory is such a fundamental element of UVM, it is important that it be able to rely on the presence of a <i>name</i> argument in object constructors.</p></div></div></div>




 <!--CONTENT index=2 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="What_users_should_do_as_soon_as_possible" href="../../../../../uvm_ref/relnotes/Mantis_3770.txt">What users should do as soon as possible</a></h3><div class=CBody><p>In UVM 1.1a, the behavior of the UVM object factory retains its previous (if incorrect) behavior by default.&nbsp; No changes are required at this time.&nbsp; However, the default behavior of the UVM object factory will change in the next release.&nbsp; It is thus important that users update their code as soon as possible to be ready to moved to UVM 1.2 when it becomes available.</p><p>The correct factory behavior can be turned on by defining the `UVM_OBJECT_MUST_HAVE_CONSTRUCTOR symbol when compiling the UVM library.</p><blockquote><pre>% ... +define+UVM_OBJECT_MUST_HAVE_CONSTRUCTOR uvm_pkg.sv</pre></blockquote><p>Enabling the corrected behavior now requires that every class extended from <a href="../../files/base/uvm_object-svh.html#uvm_object" class=LClass id=link6 onMouseOver="ShowTip(event, 'tt1', 'link6')" onMouseOut="HideTip('tt1')">uvm_object</a> have a constructor with a <i>name</i> argument.&nbsp; <b>This requirement is not backward-compatible</b> and will cause a compile-time error if a class does not contains such a constructor and instead relies on the default constructor provided by SystemVerilog.&nbsp; Fortunately, once a constructor is provided, the updated classes remain backward-compible with the old (incorrect) UVM object factory behavior.&nbsp; Users can thus migrate code forward as soon as practically possible without affecting on-going work using the default behavior of the UVM library.</p><p>Suitable constructors may be automatically added to classes that are missing them by using the <i>add_uvm_object_new.pl</i> script.&nbsp; The following command will update all SystemVerilog source files located in the current working directory and any sub-directory:</p><blockquote><pre>% add_uvm_object_new.pl --write</pre></blockquote><p>See the <i>--help</i> command-line option for more details.</p><p>The script may not be able to automatically identify all classes with missing constructors, or users may prefer to manually modify their source files.&nbsp; The script is also unable to fix unsuitable constructors; those will need to be fixed manually.&nbsp; Because the error is a compile-time error, it will be easy to identify any remaining changes that are required.&nbsp; However, because much of the factory code is hidden in the utility macros, the syntax error may not point to the ultimate cause of the problem and may be confusing the diagnose.&nbsp; For example, this simple file</p><blockquote><pre>`include &quot;uvm_macros.svh&quot;
program test;

import uvm_pkg::*;

class my_obj extends uvm_object;
   `uvm_object_utils(my_obj)
endclass

endprogram</pre></blockquote><p>will produce the following error messages:</p><h4 class=CHeading>Questa</h4><blockquote><pre>TBD</pre></blockquote><h4 class=CHeading>IUS</h4><blockquote><pre>file: test.sv
`uvm_object_utils(my_obj)
                        |
ncvlog: *E,TOOMAC (test.sv,8|24): too many actual arguments [10.2.2][10.3(IEEE)].</pre></blockquote><h4 class=CHeading>VCS</h4><blockquote><pre>Error-[TMAFTC] Too many arguments to function/task call
$UVM_HOME/src/base/uvm_registry.svh, 197
&quot;my_obj::new(name)&quot;
  The above function/task call is done with more arguments than needed.


Error-[TMAFTC] Too many arguments to function/task call
test.sv, 6
&quot;my_obj::new(name)&quot;
  The above function/task call is done with more arguments than needed.</pre></blockquote><p>When using VCS, ignore the first message reported in uvm_registry.svh and focus on the subsequent one identifying the invalid constructor being called.&nbsp; The reported line number will be on the <i>endclass</i> token of the class that is missing the required constructor.</p></div></div></div>




 <!--CONTENT index=3 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="What_will_happen_in_UVM_1.2" href="../../../../../uvm_ref/relnotes/Mantis_3770.txt">What will happen in UVM 1.2?</a></h3><div class=CBody><p>In UVM 1.2, the UVM object factory will have the corrected behavior enabled by default.&nbsp; The old (incorrect) behavior will remain available however.&nbsp; To restore the old behavior, it will be necessary to define the `UVM_OBJECT_OPTIONAL_CONSTRUCTOR symbol when compiling the UVM library:</p><blockquote><pre>% ... +define+UVM_OBJECT_OPTIONAL_CONSTRUCTOR uvm_pkg.sv</pre></blockquote><p>Users must be aware that this may result in difference in behavior in code that now relies on the correct implementation of the UVM object factory.</p></div></div></div>




 <!--CONTENT index=4 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="What_will_happen_in_UVM_1.3" href="../../../../../uvm_ref/relnotes/Mantis_3770.txt">What will happen in UVM 1.3?</a></h3><div class=CBody><p>In UVM 1.3, the UVM object factory will have the corrected behavior <b>ONLY</b>.&nbsp; The old (incorrect) behavior will no longer remain available.</p><p>This is to encourage users to migrate their code forward and enable VIP providers to eventually rely on the correct behavior of the UVM object factory.</p></div></div></div>

</div><!--Content-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CClass>
    <blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>virtual class uvm_object extends uvm_void
  </td></tr></table></blockquote>The uvm_object class is the base class for all UVM data and hierarchical classes. </div></div><div class=CToolTip id="tt2"><div class=CMethod>
    <blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype>
      <tr><td><table border=0 cellspacing=0 cellpadding=0><tr>
      <td class=PBeforeParameters nowrap>virtual function void set_name (</td>      <td class=PType nowrap>string&nbsp;</td>
      <td class=PParameter nowrap>name</td>
      <td class=PAfterParameters nowrap>)</td></tr>
      </table></td></tr>
    </table></blockquote>
Sets the instance name of this object, overwriting any previously given name.</div></div><!--END_ND_TOOLTIPS-->

<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>